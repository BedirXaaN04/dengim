(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,59544,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(75157);let a=(0,r.forwardRef)(({className:e,variant:r="primary",size:a="md",loading:i,disabled:l,children:n,...d},o)=>(0,t.jsxs)("button",{ref:o,className:(0,s.cn)("inline-flex items-center justify-center font-semibold rounded-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-primary text-black hover:bg-primary/90 active:scale-[0.98]",secondary:"bg-white/10 text-white hover:bg-white/20 border border-white/10",outline:"border border-primary/30 text-primary hover:bg-primary/10",ghost:"text-white/70 hover:text-white hover:bg-white/5",danger:"bg-rose-500/20 text-rose-500 border border-rose-500/30 hover:bg-rose-500/30"}[r],{sm:"h-8 px-3 text-xs gap-1.5",md:"h-10 px-4 text-sm gap-2",lg:"h-12 px-6 text-base gap-2",icon:"h-10 w-10"}[a],e),disabled:l||i,...d,children:[i&&(0,t.jsxs)("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n]}));a.displayName="Button",e.s(["Button",()=>a])},45283,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(63327),a=e.i(3374),i=e.i(44065),l=e.i(39964),n=e.i(59544);e.i(36180);var d=e.i(98925),o=e.i(59141);let c=async(e="open")=>{try{let t=(0,d.query)((0,d.collection)(o.db,"support_tickets"),(0,d.where)("status","==",e),(0,d.orderBy)("createdAt","desc"),(0,d.limit)(50));return(await (0,d.getDocs)(t)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Fetch tickets error:",e),[]}},m=async()=>{try{let e=(0,d.query)((0,d.collection)(o.db,"support_tickets"),(0,d.where)("status","==","open"));return(await (0,d.getCountFromServer)(e)).data().count}catch(e){return 0}},x=async e=>{try{let t=await (0,d.getDoc)((0,d.doc)(o.db,"support_tickets",e));if(t.exists())return{id:t.id,...t.data()};return null}catch(e){return console.error("Get ticket error:",e),null}},p=async(e,t)=>{try{let r=(0,d.doc)(o.db,"support_tickets",e),s=await (0,d.getDoc)(r);if(!s.exists())return!1;let a=s.data().messages||[];return a.push({...t,id:Math.random().toString(36).substring(7),createdAt:d.Timestamp.now()}),await (0,d.updateDoc)(r,{messages:a,updatedAt:d.Timestamp.now(),status:"admin"===t.senderType?"in_progress":"open"}),!0}catch(e){return console.error("Add message error:",e),!1}},u=async(e,t)=>{try{return await (0,d.updateDoc)((0,d.doc)(o.db,"support_tickets",e),{status:t,updatedAt:d.Timestamp.now()}),!0}catch(e){return console.error("Update status error:",e),!1}};var b=e.i(75157);function h(){let[e,o]=(0,r.useState)([]),[h,y]=(0,r.useState)(0),[g,j]=(0,r.useState)(!0),[f,v]=(0,r.useState)(null),[w,N]=(0,r.useState)(""),[k,C]=(0,r.useState)(!1),T=async()=>{j(!0);let[e,t]=await Promise.all([c(),m()]);o(e),y(t),j(!1)};(0,r.useEffect)(()=>{T()},[]);let S=async e=>{v(e)},A=async()=>{f&&w.trim()&&(C(!0),await p(f.id,{senderId:"admin",senderName:"Destek Ekibi",senderType:"admin",content:w})?(N(""),v(await x(f.id)),T()):alert("Yanıt gönderilemedi."),C(!1))},B=async e=>{!f||await u(f.id,e)&&(v(await x(f.id)),T())};return(0,t.jsxs)("div",{className:"flex min-h-screen bg-background-dark text-white",children:[(0,t.jsx)(s.Sidebar,{}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)(a.Header,{}),(0,t.jsxs)("main",{className:"flex-1 overflow-y-auto pb-24 md:pb-6 custom-scrollbar",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 p-4 md:p-6",children:[(0,t.jsx)(l.StatCard,{title:"Açık Talepler",value:h,icon:(0,t.jsx)("span",{className:"material-symbols-outlined",children:"confirmation_number"}),borderColor:"border-l-primary"}),(0,t.jsx)(l.StatCard,{title:"Yanıt Bekleyen",value:"0",borderColor:"border-l-accent-indigo"}),(0,t.jsx)(l.StatCard,{title:"Ort. Yanıt Süresi",value:"-",borderColor:"border-l-accent-emerald"}),(0,t.jsx)(l.StatCard,{title:"Müşteri Memnuniyeti",value:"%100",borderColor:"border-l-primary"})]}),(0,t.jsxs)("div",{className:"p-4 md:p-6 grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-1 space-y-4",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Destek Talepleri"}),g?(0,t.jsx)("div",{className:"flex justify-center py-20",children:(0,t.jsx)("div",{className:"h-10 w-10 border-4 border-primary border-t-transparent rounded-full animate-spin"})}):e.length>0?e.map(e=>(0,t.jsxs)(l.Card,{padding:"sm",hover:!0,className:(0,b.cn)(f?.id===e.id?"border-primary bg-primary/5":"border-white/5"),onClick:()=>S(e),children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("span",{className:"text-[10px] font-bold text-primary uppercase tracking-tighter",children:e.category}),(0,t.jsx)("span",{className:(0,b.cn)("text-[10px] px-1.5 py-0.5 rounded uppercase font-bold","open"===e.status?"bg-amber-500/20 text-amber-500":"in_progress"===e.status?"bg-blue-500/20 text-blue-500":"bg-emerald-500/20 text-emerald-500"),children:e.status})]}),(0,t.jsx)("h4",{className:"font-bold text-sm truncate",children:e.subject}),(0,t.jsx)("p",{className:"text-xs text-white/40 truncate",children:e.userName})]},e.id)):(0,t.jsx)("div",{className:"text-center py-12 border border-dashed border-white/10 rounded-2xl opacity-30 italic text-sm",children:"Talep bulunamadı."})]}),(0,t.jsx)("div",{className:"lg:col-span-2",children:f?(0,t.jsxs)(l.Card,{padding:"md",className:"flex flex-col h-[600px]",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start border-b border-white/5 pb-4 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-bold",children:f.subject}),(0,t.jsxs)("p",{className:"text-sm text-white/40",children:[f.userName," (",f.userEmail,")"]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(n.Button,{size:"sm",variant:"outline",onClick:()=>B("closed"),children:"Kapat"}),(0,t.jsx)(n.Button,{size:"sm",variant:"outline",onClick:()=>B("resolved"),children:"Çözüldü"})]})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto space-y-4 mb-4 pr-2 custom-scrollbar",children:f.messages?.map((e,r)=>(0,t.jsxs)("div",{className:(0,b.cn)("max-w-[80%] p-3 rounded-2xl text-sm","admin"===e.senderType?"ml-auto bg-primary text-black rounded-tr-none":"bg-white/5 border border-white/10 rounded-tl-none"),children:[(0,t.jsx)("p",{children:e.content}),(0,t.jsx)("p",{className:(0,b.cn)("text-[10px] mt-1 text-right","admin"===e.senderType?"text-black/50":"text-white/30"),children:e.createdAt instanceof d.Timestamp?(0,b.formatRelativeTime)(e.createdAt.toDate()):"Az önce"})]},r))}),(0,t.jsxs)("div",{className:"flex gap-2 bg-white/5 p-2 rounded-xl",children:[(0,t.jsx)("input",{value:w,onChange:e=>N(e.target.value),placeholder:"Bir yanıt yazın...",className:"flex-1 bg-transparent border-none outline-none px-2 text-sm",onKeyDown:e=>"Enter"===e.key&&A()}),(0,t.jsx)(n.Button,{size:"icon",onClick:A,loading:k,disabled:!w.trim(),children:(0,t.jsx)("span",{className:"material-symbols-outlined",children:"send"})})]})]}):(0,t.jsxs)("div",{className:"h-full flex flex-col items-center justify-center opacity-20 py-24 border border-dashed border-white/10 rounded-3xl",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-6xl mb-4",children:"forum"}),(0,t.jsx)("p",{className:"font-bold",children:"Görüntülemek için bir talep seçin"})]})})]})]}),(0,t.jsx)(i.BottomNav,{})]})]})}e.s(["default",()=>h],45283)}]);