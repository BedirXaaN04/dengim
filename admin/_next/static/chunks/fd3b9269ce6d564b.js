(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,59544,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(75157);let i=(0,r.forwardRef)(({className:e,variant:r="primary",size:i="md",loading:s,disabled:l,children:n,...c},d)=>(0,t.jsxs)("button",{ref:d,className:(0,a.cn)("inline-flex items-center justify-center font-semibold rounded-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-primary text-black hover:bg-primary/90 active:scale-[0.98]",secondary:"bg-white/10 text-white hover:bg-white/20 border border-white/10",outline:"border border-primary/30 text-primary hover:bg-primary/10",ghost:"text-white/70 hover:text-white hover:bg-white/5",danger:"bg-rose-500/20 text-rose-500 border border-rose-500/30 hover:bg-rose-500/30"}[r],{sm:"h-8 px-3 text-xs gap-1.5",md:"h-10 px-4 text-sm gap-2",lg:"h-12 px-6 text-base gap-2",icon:"h-10 w-10"}[i],e),disabled:l||s,...c,children:[s&&(0,t.jsxs)("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n]}));i.displayName="Button",e.s(["Button",()=>i])},11765,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(63327),i=e.i(3374),s=e.i(44065),l=e.i(39964),n=e.i(59544),c=e.i(75157);e.i(36180);var d=e.i(98925),o=e.i(59141);let m=async()=>{try{let e=(0,d.collection)(o.db,"users"),t=new Date;t.setDate(t.getDate()-7);let r=d.Timestamp.fromDate(t),[a,i,s,l]=await Promise.all([(0,d.getCountFromServer)(e),(0,d.getCountFromServer)((0,d.query)(e,(0,d.where)("isPremium","==",!0))),(0,d.getCountFromServer)((0,d.query)(e,(0,d.where)("createdAt",">=",r))),(0,d.getCountFromServer)((0,d.query)(e,(0,d.where)("lastActive","<",r)))]);return{all:a.data().count,premium:i.data().count,new:s.data().count,inactive:l.data().count}}catch(e){return console.error("Segment counts error:",e),{all:0,premium:0,new:0,inactive:0}}},x=async e=>{try{let t,r=(0,d.collection)(o.db,"users"),a=new Date;a.setDate(a.getDate()-7);let i=d.Timestamp.fromDate(a);switch(e.segment){case"premium":t=(0,d.query)(r,(0,d.where)("isPremium","==",!0));break;case"new":t=(0,d.query)(r,(0,d.where)("createdAt",">=",i));break;case"inactive":t=(0,d.query)(r,(0,d.where)("lastActive","<",i));break;default:t=(0,d.query)(r)}let s=await (0,d.getDocs)(t),l=s.docs.length,n=await (0,d.addDoc)((0,d.collection)(o.db,"announcements"),{title:e.title,body:e.body,segment:e.segment,imageUrl:e.imageUrl||null,createdAt:d.Timestamp.now(),isActive:!0,sentCount:l}),c=0;for(let t=0;t<s.docs.length;t+=400){let r=(0,d.writeBatch)(o.db),a=s.docs.slice(t,t+400);for(let t of a){let a=(0,d.doc)((0,d.collection)(o.db,"users",t.id,"notifications"));r.set(a,{type:"announcement",title:e.title,body:e.body,imageUrl:e.imageUrl||null,announcementId:n.id,senderId:"admin",isRead:!1,createdAt:d.Timestamp.now(),data:{segment:e.segment}})}await r.commit(),c+=a.length}return await (0,d.addDoc)((0,d.collection)(o.db,"notification_queue"),{...e,announcementId:n.id,status:"sent",createdAt:d.Timestamp.now(),sentCount:c,totalTarget:l}),{success:!0,sentCount:c}}catch(e){return console.error("Send notification error:",e),{success:!1,sentCount:0}}},u=async()=>{try{let e=(0,d.query)((0,d.collection)(o.db,"notification_queue"),(0,d.orderBy)("createdAt","desc"),(0,d.limit)(30));return(await (0,d.getDocs)(e)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Get history error:",e),[]}},h=async()=>{try{let e=(0,d.query)((0,d.collection)(o.db,"announcements"),(0,d.where)("isActive","==",!0),(0,d.orderBy)("createdAt","desc"),(0,d.limit)(10));return(await (0,d.getDocs)(e)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Get announcements error:",e),[]}},p=async e=>{try{return await (0,d.updateDoc)((0,d.doc)(o.db,"announcements",e),{isActive:!1}),!0}catch(e){return console.error("Deactivate announcement error:",e),!1}};function b(){let[e,o]=(0,r.useState)("push"),[b,y]=(0,r.useState)("all"),[g,w]=(0,r.useState)({all:0,premium:0,new:0,inactive:0}),[f,j]=(0,r.useState)(!1),[v,N]=(0,r.useState)(null),[k,C]=(0,r.useState)([]),[S,A]=(0,r.useState)(!1),[B,D]=(0,r.useState)([]),[T,z]=(0,r.useState)(!1),[q,G]=(0,r.useState)(""),[U,P]=(0,r.useState)(""),[K,L]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{w(await m())})()},[]),(0,r.useEffect)(()=>{"history"===e&&(async()=>{A(!0),C(await u()),A(!1)})(),"announcements"===e&&(async()=>{z(!0),D(await h()),z(!1)})()},[e]);let R=async()=>{if(!q||!U)return alert("BaÅŸlÄ±k ve iÃ§eriÄŸi doldurun!");if(!confirm(`"${q}" bildirimi ${"all"===b?"TÃœM":b.toUpperCase()} kullanÄ±cÄ±lara (${"all"===b?g.all:"premium"===b?g.premium:"new"===b?g.new:g.inactive} kiÅŸi) g\xf6nderilecek. Emin misiniz?`))return;j(!0);let e=await x({title:q,body:U,segment:b,imageUrl:K||void 0});e.success?(N({message:`Bildirim ${e.sentCount} kullanÄ±cÄ±ya baÅŸarÄ±yla g\xf6nderildi!`,count:e.sentCount}),G(""),P(""),L(""),setTimeout(()=>N(null),5e3)):alert("Bir hata oluÅŸtu. Konsolu kontrol edin."),j(!1)},_=async e=>{!confirm("Bu duyuruyu devre dÄ±ÅŸÄ± bÄ±rakmak istediÄŸinize emin misiniz?")||await p(e)&&D(t=>t.filter(t=>t.id!==e))},F=e=>{switch(e){case"all":return"TÃ¼m KullanÄ±cÄ±lar";case"premium":return"Premium Ãœyeler";case"new":return"Yeni Ãœyeler";case"inactive":return"Ä°naktif Ãœyeler";default:return e}};return(0,t.jsxs)("div",{className:"flex min-h-screen bg-background-dark",children:[(0,t.jsx)(a.Sidebar,{}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)(i.Header,{}),(0,t.jsxs)("main",{className:"flex-1 overflow-y-auto pb-24 md:pb-6 custom-scrollbar text-white",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 p-4 md:p-6",children:[(0,t.jsx)(l.StatCard,{title:"Toplam KullanÄ±cÄ±",value:g.all.toLocaleString(),borderColor:"border-l-primary"}),(0,t.jsx)(l.StatCard,{title:"Premium Ãœyeler",value:g.premium.toLocaleString(),borderColor:"border-l-accent-indigo"}),(0,t.jsx)(l.StatCard,{title:"Yeni Ãœyeler (7g)",value:g.new.toLocaleString(),borderColor:"border-l-accent-emerald"}),(0,t.jsx)(l.StatCard,{title:"Ä°naktif Ãœyeler",value:g.inactive.toLocaleString(),borderColor:"border-l-red-500"})]}),(0,t.jsx)("div",{className:"flex border-b border-white/10 px-4 gap-6 sticky top-0 bg-background-dark z-10",children:[{key:"push",label:"Bildirim GÃ¶nder"},{key:"announcements",label:"Aktif Duyurular"},{key:"history",label:"GeÃ§miÅŸ"}].map(({key:r,label:a})=>(0,t.jsx)("button",{onClick:()=>o(r),className:(0,c.cn)("pb-3 pt-4 text-sm font-bold border-b-[3px] transition-colors",e===r?"text-white border-primary":"text-white/50 border-transparent hover:text-white/70"),children:a},r))}),(0,t.jsxs)("div",{className:"p-4 md:p-6",children:["push"===e&&(0,t.jsx)("div",{className:"max-w-3xl",children:(0,t.jsxs)(l.Card,{glass:!0,className:"mb-6",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-white mb-2",children:"ðŸ“¢ Duyuru Bildirimi GÃ¶nder"}),(0,t.jsxs)("p",{className:"text-xs text-white/40 mb-6",children:["Bu bildirim seÃ§ilen segmentteki tÃ¼m kayÄ±tlÄ± kullanÄ±cÄ±lara gÃ¶nderilir. AyrÄ±ca ",(0,t.jsx)("strong",{children:"yeni kayÄ±t olacak kullanÄ±cÄ±lar"})," da bu duyuruyu bildirim panelinde gÃ¶rebilir."]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"text-xs font-bold text-white/40 mb-3 block uppercase tracking-wider",children:"Hedef Kitle"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:[{id:"all",label:"TÃ¼m KullanÄ±cÄ±lar",count:g.all,icon:"ðŸŒ"},{id:"premium",label:"Premium Ãœyeler",count:g.premium,icon:"ðŸ‘‘"},{id:"new",label:"Yeni Ãœyeler (7g)",count:g.new,icon:"ðŸ†•"},{id:"inactive",label:"Ä°naktif Ãœyeler",count:g.inactive,icon:"ðŸ˜´"}].map(e=>(0,t.jsxs)("button",{onClick:()=>y(e.id),className:(0,c.cn)("px-4 py-2.5 rounded-xl text-sm font-semibold transition-all border",b===e.id?"bg-primary text-black border-primary":"bg-white/5 text-white/60 border-white/5 hover:border-white/20"),children:[e.icon," ",e.label,(0,t.jsx)("span",{className:"ml-2 opacity-60 text-xs font-bold",children:e.count})]},e.id))})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-bold text-white/40 mb-2 block uppercase tracking-wider",children:"BaÅŸlÄ±k *"}),(0,t.jsx)("input",{value:q,onChange:e=>G(e.target.value),placeholder:"Ã–rn: ðŸŽ‰ Yeni GÃ¼ncelleme Geldi!",maxLength:100,className:"w-full h-12 bg-white/5 border border-white/10 rounded-xl px-4 text-white focus:border-primary outline-none transition-all"}),(0,t.jsxs)("span",{className:"text-[10px] text-white/20 mt-1 block",children:[q.length,"/100"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-bold text-white/40 mb-2 block uppercase tracking-wider",children:"Ä°Ã§erik *"}),(0,t.jsx)("textarea",{value:U,onChange:e=>P(e.target.value),rows:3,maxLength:500,placeholder:"Bildirim detaylarÄ±nÄ± buraya yazÄ±n...",className:"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:border-primary outline-none transition-all resize-none"}),(0,t.jsxs)("span",{className:"text-[10px] text-white/20 mt-1 block",children:[U.length,"/500"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-bold text-white/40 mb-2 block uppercase tracking-wider",children:"GÃ¶rsel URL (Opsiyonel)"}),(0,t.jsx)("input",{value:K,onChange:e=>L(e.target.value),placeholder:"https://...",className:"w-full h-12 bg-white/5 border border-white/10 rounded-xl px-4 text-white focus:border-primary outline-none"})]}),(q||U)&&(0,t.jsxs)("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/10",children:[(0,t.jsx)("p",{className:"text-[10px] text-white/30 mb-2 uppercase tracking-wider font-bold",children:"Ã–nizleme"}),(0,t.jsxs)("div",{className:"flex gap-3 items-start",children:[(0,t.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary/20 flex items-center justify-center shrink-0",children:(0,t.jsx)("span",{className:"material-symbols-outlined text-primary text-lg",children:"campaign"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-white font-bold text-sm",children:q||"BaÅŸlÄ±k..."}),(0,t.jsx)("p",{className:"text-white/60 text-xs mt-0.5",children:U||"Ä°Ã§erik..."})]})]})]}),v&&(0,t.jsxs)("div",{className:"p-4 bg-emerald-500/10 border border-emerald-500/20 rounded-xl flex items-center gap-3",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-emerald-400",children:"check_circle"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-emerald-400 font-bold text-sm",children:v.message}),(0,t.jsxs)("p",{className:"text-emerald-400/60 text-xs",children:[v.count," kullanÄ±cÄ±ya baÅŸarÄ±yla iletildi"]})]})]}),(0,t.jsxs)(n.Button,{onClick:R,loading:f,className:"w-full h-14 text-base mt-2",children:[(0,t.jsx)("span",{className:"material-symbols-outlined mr-2",children:"send_to_mobile"}),f?"GÃ¶nderiliyor...":"Bildirimi Hemen GÃ¶nder"]}),(0,t.jsx)("p",{className:"text-[10px] text-white/20 text-center",children:"âš ï¸ Bildirim gÃ¶nderildiÄŸinde geri alÄ±namaz. TÃ¼m hedef kullanÄ±cÄ±lara anÄ±nda iletilir."})]})]})}),"announcements"===e&&(0,t.jsxs)("div",{className:"space-y-4 max-w-3xl",children:[(0,t.jsx)("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-2xl mb-4",children:(0,t.jsxs)("p",{className:"text-blue-400 text-sm",children:[(0,t.jsx)("strong",{children:"ðŸ’¡ Not:"})," Aktif duyurular yeni kayÄ±t olan kullanÄ±cÄ±lara da otomatik olarak gÃ¶sterilir. Devre dÄ±ÅŸÄ± bÄ±rakÄ±lan duyurular artÄ±k yeni kullanÄ±cÄ±lara gÃ¶sterilmez."]})}),T?(0,t.jsx)("div",{className:"flex justify-center py-20",children:(0,t.jsx)("div",{className:"h-10 w-10 border-4 border-primary border-t-transparent rounded-full animate-spin"})}):B.length>0?B.map(e=>(0,t.jsx)(l.Card,{padding:"sm",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:(0,t.jsx)("span",{className:"material-symbols-outlined text-primary",children:"campaign"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,t.jsx)("h4",{className:"font-bold text-white",children:e.title}),(0,t.jsx)("button",{onClick:()=>_(e.id),className:"text-xs text-red-400 hover:text-red-300 bg-red-500/10 px-2 py-1 rounded-lg transition-colors",children:"Devre DÄ±ÅŸÄ± BÄ±rak"})]}),(0,t.jsx)("p",{className:"text-sm text-white/60 mb-2",children:e.body}),(0,t.jsxs)("div",{className:"flex gap-3 items-center flex-wrap",children:[(0,t.jsx)("span",{className:"text-[10px] font-bold text-primary uppercase tracking-tighter bg-primary/10 px-2 py-0.5 rounded",children:F(e.segment)}),(0,t.jsxs)("span",{className:"text-[10px] text-white/30",children:["ðŸ“¤ ",e.sentCount||0," kiÅŸiye gÃ¶nderildi"]}),(0,t.jsx)("span",{className:"text-[10px] text-white/30",children:e.createdAt instanceof d.Timestamp?(0,c.formatRelativeTime)(e.createdAt.toDate()):"Az Ã¶nce"})]})]})]})},e.id)):(0,t.jsxs)("div",{className:"text-center py-24 border border-dashed border-white/10 rounded-3xl opacity-30",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-6xl mb-4",children:"campaign"}),(0,t.jsx)("p",{children:"Aktif duyuru bulunmuyor."})]})]}),"history"===e&&(0,t.jsx)("div",{className:"space-y-4 max-w-3xl",children:S?(0,t.jsx)("div",{className:"flex justify-center py-20",children:(0,t.jsx)("div",{className:"h-10 w-10 border-4 border-primary border-t-transparent rounded-full animate-spin"})}):k.length>0?k.map(e=>(0,t.jsx)(l.Card,{padding:"sm",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"h-10 w-10 rounded-full bg-white/5 flex items-center justify-center shrink-0",children:(0,t.jsx)("span",{className:"material-symbols-outlined text-white/40",children:"notifications"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,t.jsx)("h4",{className:"font-bold text-white",children:e.title}),(0,t.jsx)("span",{className:"text-[10px] text-white/30",children:e.createdAt instanceof d.Timestamp?(0,c.formatRelativeTime)(e.createdAt.toDate()):"Az Ã¶nce"})]}),(0,t.jsx)("p",{className:"text-sm text-white/60 mb-2",children:e.body}),(0,t.jsxs)("div",{className:"flex gap-4 items-center flex-wrap",children:[(0,t.jsx)("span",{className:"text-[10px] font-bold text-primary uppercase tracking-tighter bg-primary/10 px-2 py-0.5 rounded",children:F(e.segment)}),(0,t.jsxs)("span",{className:"text-[10px] text-white/30",children:["ðŸ“¤ ",e.sentCount||0," / ",e.totalTarget||"?"," kiÅŸi"]}),(0,t.jsx)("span",{className:(0,c.cn)("text-[10px] uppercase tracking-tighter font-bold px-2 py-0.5 rounded","sent"===e.status?"text-emerald-400 bg-emerald-500/10":"text-yellow-400 bg-yellow-500/10"),children:"sent"===e.status?"âœ… GÃ¶nderildi":"â³ "+e.status})]})]})]})},e.id)):(0,t.jsxs)("div",{className:"text-center py-24 border border-dashed border-white/10 rounded-3xl opacity-30",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-6xl mb-4",children:"history"}),(0,t.jsx)("p",{children:"Bildirim geÃ§miÅŸi ÅŸu an boÅŸ."})]})})]})]}),(0,t.jsx)(s.BottomNav,{})]})]})}e.s(["default",()=>b],11765)}]);